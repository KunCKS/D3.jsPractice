{"version":3,"sources":["webpack:///./src/components/BarChart.vue?fdbd","webpack:///src/components/BarChart.vue","webpack:///./src/components/BarChart.vue?25f1","webpack:///./src/components/BarChart.vue","webpack:///./src/components/BarChart.vue?1038","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/core-js/modules/es.array.concat.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","id","staticRenderFns","name","data","rawData","LocationsData","methods","drawChart","top","bottom","left","right","console","log","x","bandwidth","g","append","selectAll","getLocationsData","vm","res","map","created","mounted","component","toPrimitive","definePropertyModule","createPropertyDescriptor","module","exports","object","key","value","propertyKey","f","$","fails","isArray","isObject","toObject","toLength","createProperty","arraySpeciesCreate","arrayMethodHasSpeciesSupport","wellKnownSymbol","V8_VERSION","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","array","concat","SPECIES_SUPPORT","isConcatSpreadable","O","spreadable","undefined","FORCED","target","proto","forced","arg","i","k","length","len","E","A","n","arguments","TypeError"],"mappings":"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","file":"js/chunk-7c55fe36.bed82465.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"position\":\"relative\"},attrs:{\"id\":(\"bar-chart-\" + _vm.id)}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :id=\"`bar-chart-${id}`\" style=\"position:relative\"></div>\n</template>\n<script>\nimport * as d3 from \"d3\";\nimport shortid from \"shortid\";\nimport axios from \"axios\";\nexport default {\n  name: \"BarChart\",\n  data() {\n    return {\n      id: shortid.generate(),\n      rawData: [\n        {\n          value: 10,\n          name: \"18:35\"\n        },\n        {\n          value: 12,\n          name: \"18:55\"\n        },\n        {\n          value: 30,\n          name: \"19:15\"\n        },\n        {\n          value: 18,\n          name: \"19:35\"\n        },\n        {\n          value: 6,\n          name: \"19:55\"\n        },\n        {\n          value: 17,\n          name: \"20:15\"\n        },\n        {\n          value: 16,\n          name: \"20:35\"\n        },\n        {\n          value: 9,\n          name: \"20:55\"\n        },\n        {\n          value: 3,\n          name: \"21:15\"\n        },\n        {\n          value: 1,\n          name: \"21:35\"\n        },\n        {\n          value: 5,\n          name: \"21:55\"\n        }\n      ],\n      LocationsData: []\n    };\n  },\n  methods: {\n    drawChart() {\n      // 設定 svg chart 外的圖示或座標空間\n      const margin = {\n        top: 20,\n        bottom: 20,\n        left: 10,\n        right: 10\n      };\n      const chartWidth = 520 - margin.left - margin.right; // 計算SVG的寬度\n      const chartHeight = 280 - margin.top - margin.bottom; // 計算SVG的高度\n      // 設定 x 方向分段比例（Band Scale），計算等比例的區間，並 return 出來\n      const x = d3\n        .scaleBand()\n        .domain(\n          this.rawData.map(a => {\n            return a.name;\n          })\n        ) // 實際有幾個分段\n        .range([0, chartWidth]) // 畫布大小\n        .paddingInner(0.4);\n      // eslint-disable-next-line no-console\n      console.log(\"x.bandwidth\", x.bandwidth);\n      // eslint-disable-next-line no-console\n      console.log(\"x\", x);\n      // 設定 ｙ 方向線性比例（Linear Scale）\n      // eslint-disable-next-line no-unused-vars\n      const y = d3\n        .scaleLinear()\n        .domain([\n          0,\n          d3.max(\n            this.rawData.map(d => {\n              // eslint-disable-next-line no-console\n              console.log(d.value);\n              return d.value;\n            })\n          )\n        ])\n        .range([chartHeight, 0]); // 數據顛倒，帶入數值越大，計算後的數字越小\n      // 選取 div 產生 svg\n      const svg = d3\n        .select(`#bar-chart-${this.id}`)\n        .attr(\n          \"style\",\n          `width:${chartWidth +\n            margin.left +\n            margin.right}px;height:${chartHeight +\n            margin.top +\n            margin.bottom}px;position:relative`\n        )\n        .append(\"svg\")\n        .attr(\"width\", chartWidth + margin.left + margin.right)\n        .attr(\"height\", chartHeight + margin.top + margin.bottom);\n      // 生成 g 組件並移動到 svg 中間\n      const g = svg\n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n      const xAxisCall = d3.axisLeft(y).tickSize(chartWidth);\n      // 產生後方 y軸座標並延長 tick 長度，這邊原本寫在生成長柱體的後面，但這樣會蓋過柱體，所以改寫在前面\n      g.append(\"g\")\n        .call(xAxisCall)\n        .attr(\"transform\", `translate(${chartWidth},0)`)\n        .attr(\"class\", \"y-axis\");\n      // g組件內生成長柱體\n      g.selectAll(\".bar\")\n        .data(this.rawData)\n        .enter()\n        .append(\"rect\")\n        .attr(\"class\", \"bar\")\n        .attr(\"width\", x.bandwidth) // x.bandwidth  是 function 會 return bandwidth\n        .attr(\"x\", d => {\n          return x(d.name);\n        }) // 當 attr 第 2參數是函式時，會按順序載入數據，這邊利用 scaleband 來幫我們計算分段 x\n        .attr(\"y\", chartHeight) //動畫開始前的y是圖表底部，柱子才會從底下開始長，動畫過程包含height變高及往上位移\n        .attr(\"fill\", \"#0990CA\")\n        .attr(\"rx\", \"4\") // x軸 圓角\n        .attr(\"height\", 0)\n        .transition()\n        .duration(1500)\n        .ease(d3.easeBounce) // 動畫時間曲線\n        .attr(\"height\", d => chartHeight - y(d.value)) // scale後的結果是顛倒的，這邊利用chartHeight 最大值去扣掉，計算要呈現的數值，再位移到適當位置\n        .attr(\"y\", d => y(d.value)); // 因 SVG的(x,y)是從左上角開始，要以下方 x軸開始堆積長柱，需要位移，故利用 Scale後的值來位移\n      // 生成 x 座標文字\n      g.selectAll(\".label\")\n        .data(this.rawData)\n        .enter()\n        .append(\"text\")\n        .attr(\"class\", \"label\")\n        .text((d, i) => (i % 2 === 0 ? d.name : \"\")) // 奇數位置給予空字串，不要顯示，讓下方數字不要太壅擠\n        .attr(\"x\", d => x(d.name) + x.bandwidth() / 2) // x(d.name)的位置其實是柱子的最左邊，所以文字位置還必須加上半個柱子的寬度\n        .attr(\"y\", chartHeight + margin.bottom)\n        .attr(\"font-size\", \"12\")\n        .attr(\"text-anchor\", \"middle\") // 文字置中\n        .attr(\"color\", \"#9B9B9B\");\n      // 生成透明 bar 作為 hover 觸發 tooltip 使用\n      g.selectAll(\".hover-bar\")\n        .data(this.rawData)\n        .enter()\n        .append(\"rect\")\n        .attr(\"class\", \"hover-bar\")\n        .attr(\"fill\", \"transparent\")\n        .attr(\"height\", chartHeight) // 每個 hover-bar 都一樣高\n        .attr(\"width\", x.step) // 寬度包含 inner\n        .attr(\"y\", 0)\n        .attr(\"x\", d => x(d.name) - (x.step() - x.bandwidth()) / 2) // 這邊 step跟 bandwidth要用函式方式取得，往後位移一半的 inner\n        .on(\"mouseover\", d => {\n          // 監控滑鼠動作\n          dashLine\n            .attr(\"x1\", x(d.name) + x.bandwidth() / 2)\n            .attr(\"x2\", x(d.name) + x.bandwidth() / 2)\n            .attr(\"opacity\", 0.8);\n          d3.select(\".tooltip-wrapper .data\").html(`${d.value} mm`);\n          tooltip.attr(\"style\", () => {\n            return `display:flex;left: ${x(d.name) + 35}px`;\n          });\n        })\n        .on(\"mouseleave\", () => {\n          dashLine.attr(\"opacity\", 0);\n          tooltip.attr(\"style\", \"display: none;\");\n        });\n      // 添加 svg 直線到中，並設定樣式屬性\n      const dashLine = g\n        .append(\"line\")\n        .attr(\"y1\", 0)\n        .attr(\"y2\", chartHeight)\n        .attr(\"stroke\", \"#454545\")\n        .attr(\"stroke-width\", 1)\n        .attr(\"stroke-dasharray\", 8)\n        .attr(\"opacity\", 0); // 先隱藏\n      // 添加 tooltip 到 div 內，並在tooltip內寫入兩個tag，分別作為圓形及文字訊息所用，其餘樣式都是透過CSS去撰寫，\n      // 另外要記得到div添加position:relative\n      const tooltip = d3\n        .select(`#bar-chart-${this.id}`)\n        .append(\"div\")\n        .attr(\"class\", \"tooltip-wrapper\")\n        .html('<div class=\"circle\"></div><div class=\"data\">123444</div>')\n        .attr(\"style\", \"display:none\"); // 先隱藏\n    },\n    getLocationsData() {\n      const vm = this;\n      const api = \"https://works.ioa.tw/weather/api/all.json\";\n      axios.get(api).then(res => {\n        vm.LocationsData = res.data.map(city => ({\n          label: city.name,\n          value: city.id\n        }));\n      });\n    }\n  },\n  created() {\n    this.getLocationsData();\n  },\n  mounted() {\n    this.drawChart();\n  }\n};\n</script>\n<style lang=\"scss\">\n// // 改變 y 座標 tick 顏色\n// .y-axis .tick line {\n//   stroke: #e8e8e8;\n// }\n// // 隱藏偶數條 tick\n// .y-axis .tick:nth-child(even) {\n//   display: none;\n// }\n// // 隱藏座標的數值\n// .y-axis text {\n//   display: none;\n// }\n// // 隱藏 y 座標\n// .y-axis .domain {\n//   display: none;\n// }\n// .tooltip-wrapper {\n//   border-radius: 4px;\n//   width: 102px;\n//   height: 34px;\n//   background: #f9f9f9;\n//   box-shadow: 0 2px 9px 0 rgba(0, 0, 0, 0.3);\n//   position: absolute;\n//   top: 0px;\n//   align-items: center;\n//   padding-left: 15px;\n// }\n// .tooltip-wrapper .circle {\n//   border-radius: 50%;\n//   height: 11px;\n//   width: 11px;\n//   background-color: #0990ca;\n// }\n// .tooltip-wrapper .data {\n//   font-size: 12px;\n//   color: #7e7e7e;\n//   margin-left: 10px;\n// }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BarChart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BarChart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BarChart.vue?vue&type=template&id=e3ef512c&\"\nimport script from \"./BarChart.vue?vue&type=script&lang=js&\"\nexport * from \"./BarChart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BarChart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BarChart.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BarChart.vue?vue&type=style&index=0&lang=scss&\"","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n"],"sourceRoot":""}